<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
    <title>Stencil Component Starter</title>
    <link rel="stylesheet" href="/build/xbase.css">
    <script type="module" src="/build/xbase.esm.js"></script>
    <script nomodule src="/build/xbase.js"></script>
    <style>
      body {
        margin: 0;
      }
      .my-slider__slide {
        height: 300px;
        background: #aaa;
        background-image: url('https://picsum.photos/600/400?');
        background-size: cover;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 30px;
        font-weight: bold;
      }
      azwc-swiper {
        height: 100%;
        overflow-y: hidden;
      }
      .swiper-container {
        height: 100%;
        overflow-y: hidden;
      }
    </style>
  </head>
  <body>
    <my-component first="Stencil" last="'Don't call me a framework' JS"></my-component>
    <azwc-dialog>
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
      Content<br />
    </azwc-dialog>
    <azwc-file-manager>
      Content
    </azwc-file-manager>
    <azwc-spinner></azwc-spinner>
    <div style="width: 400px; height: 400px; position: relative; overflow-y: hidden;">
      <azwc-spinner-mask enabled="true"></azwc-spinner-mask>
      SVSVRSV
      <button>WRVREV</button>
    </div>
    <div style="height: 300px; position: relative;">
      <azwc-swiper
        id="swr"
        class="my-slider"
        loop="true"
        speed="500">
        <div class="swiper-slide my-slider__slide">Slide 1</div>
        <div class="swiper-slide my-slider__slide">Slide 2</div>
        <div class="swiper-slide my-slider__slide">Slide 3</div>
      </azwc-swiper>
    </div>
  </body>
  <script>
    function promiseWait(waitMillisec) {
      return new Promise((resolve, reject) => {
        setTimeout(resolve, waitMillisec);
      });
    }

    var caches = {};
    var createFileList = preFix => [
      {
        name: `${preFix}-1`,
        relPath: `${preFix}-1`,
        type: 'folder',
      },
      {
        name: `${preFix}-2`,
        relPath: `${preFix}-2`,
        type: 'folder',
      },
      {
        name: `${preFix}-3`,
        relPath: `${preFix}-3`,
        type: 'folder',
      },
      {
        name: `${preFix}-4.js`,
        relPath: `${preFix}-4.js`,
        type: 'file',
      },
      {
        name: `${preFix}-5.js`,
        relPath: `${preFix}-5.js`,
        type: 'file',
      },
      {
        name: `${preFix}-6.js`,
        relPath: `${preFix}-6.js`,
        type: 'file',
      },
      {
        name: `${preFix}-7.js`,
        relPath: `${preFix}-7.js`,
        type: 'file',
      },
      {
        name: `${preFix}-8.js`,
        relPath: `${preFix}-8.js`,
        type: 'file',
      },
      {
        name: `${preFix}-9.js`,
        relPath: `${preFix}-9.js`,
        type: 'file',
      },
      {
        name: `${preFix}-10.js`,
        relPath: `${preFix}-10.js`,
        type: 'file',
      },
    ];

    const canCreate = async ({
      filename,
      type,
      params: {
        options: {
          paths,
        },
      },
    }) => {
      if (!filename) {
        return 'Filename or folder name is empty!!'
      }
      const path = paths.join('/');
      caches[path] = caches[path] || createFileList(preFix);
      const found = caches[path].find(info => info.relPath === filename);
      if (found && found.type === 'folder') {
        return 'Folder with the same name exists!!'
      }
    };

    const isFileExists = async ({
      filename,
      type,
      params: {
        options: {
          paths,
        },
      },
    }) => {
      const path = paths.join('/');
      caches[path] = caches[path] || createFileList(preFix);
      const found = caches[path].find(info => info.relPath === filename);
      if (found && found.type === 'file') {
        return true;
      }
      return false;
    };

    const createFileOrFolder = async ({
      filename,
      params: {
        options: {
          paths,
        },
      },
    }) => {
      const path = paths.join('/');
      caches[path] = caches[path] || createFileList(preFix);
      const found = caches[path].find(info => info.relPath === filename);
      if (!found) {
        caches[path].push({
          name: filename,
          relPath: filename,
          type: 'folder',
        });
      }
    };

    const getFileList = async (paths) => {
      await promiseWait(1000);
      const path = paths.join('/');
      const preFix = paths.length ? paths[paths.length - 1] : 'save-data';
      caches[path] = caches[path] || createFileList(preFix);
      // console.log('preFix :', preFix);
      // await promiseWait(500);
      return caches[path];
    };

    var fileApi = {
      canCreate,
      isFileExists,
      createFileOrFolder,
      getFileList,
    };
  </script>
  <script>
    window.__on_azwc_init = (azwc_classes, options) => {
      console.log('azwc_classes :', azwc_classes);
      var AzwcSwiper = azwc_classes.AzwcSwiper;
      var Swiper = azwc_classes.thirdParty.Swiper;
      AzwcSwiper.componentDidLoad = (inst) => {
        console.log('inst :', inst);
        console.log('inst.host.id :', inst.host.id);
      }
      AzwcSwiper.createSwiper = (inst) => {
        return new Swiper(inst.container, {
          ...AzwcSwiper.getDefaultOptions(inst),
          effect: 'fade',
          // direction: 'vertical',
          mousewheel: true,
        });
      }
    }

    // customElements.whenDefined('azwc-file-manager')
    // .then((x) => {
    //   console.log('x :', x);
    //   var afm = document.querySelector('azwc-file-manager');
    //   afm.componentOnReady()
    //   .then(() => {
    //     setTimeout(() => {
    //       var ct = 1;
    //       afm.setApi(fileApi);
    //       // setInterval(() => {
    //       //   if (ct) {
    //       //     ct = 0;
    //       //     afm.setAttribute('base-path', '/wwwww')
    //       //   } else {
    //       //     ct = 1;
    //       //     afm.setAttribute('base-path', '/ooooo')
    //       //   }
    //       // }, 3000);
    //     }, 3000);
    //   });

    //   var as = document.querySelector('azwc-swiper');
    //   as.componentOnReady()
    //   .then(() => {
    //     setTimeout(() => {
    //       as.slideTo(3);
    //     }, 3000);
    //   });
    // });
    customElements.whenDefined('azwc-swiper')
    .then((x) => {
      var as = document.querySelector('azwc-swiper');
      as.componentOnReady()
      .then(() => {
        setTimeout(() => {
          // as.slideTo(3, 300);
          as.getSwiper()
          .then((swiper) => {
            console.log('swiper.activeIndex :', swiper.activeIndex);
          });
        }, 3000);
      });
    });
    document.addEventListener('customStateChange', function handleChange(e) {
      console.log('Event Recieved:', e);
    });
  </script>
</html>
